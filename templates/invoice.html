<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Tax Invoice â€“ {{ invoice.invoice_number }}</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
/* ======== SIMPLE PROFESSIONAL INVOICE ======== */
:root{
    --text:#1e293b;
    --muted:#64748b;
    --border:#d1d5db;
    --table:#f3f4f6;
    --light:#fafafa;
}

body{
    font-family:Arial, sans-serif;
    font-size:12px;
    margin:0;
    background:#fff;
}

/* Header */
.header{
    padding:12px 24px;
    display:flex;
    align-items:center;
    justify-content:space-between;
    border-bottom:1px solid var(--border);
}
.header img{
    height:70px;
}
.header-title{
    font-size:22px;
    font-weight:600;
}

/* Section Title */
.section-title{
    font-size:12px;
    font-weight:600;
    padding:6px 10px;
    background:#efefef;
    border-bottom:1px solid var(--border);
}

/* Parties table */
.party-table{
    width:100%;
    border-collapse:collapse;
}
.party-table td{
    width:33%;
    padding:8px 10px;
    border-right:1px solid var(--border);
    vertical-align:top;
}
.party-table td:last-child{
    border-right:0;
}
.party-title{
    font-weight:600;
    margin-bottom:4px;
}
.party-line{
    font-size:11.5px;
    color:var(--muted);
}

/* Invoice meta */
.meta-table{
    width:100%;
    border-collapse:collapse;
}
.meta-table td{
    padding:6px 10px;
    border:1px solid var(--border);
    font-size:12px;
}
.meta-label{
    width:30%;
    font-weight:600;
}

/* Items table */
table.items{
    width:100%;
    border-collapse:collapse;
    margin-top:8px;
}
.items th{
    background:var(--table);
    border:1px solid var(--border);
    padding:6px 2px;
    font-size:12px;
}
.items td{
    border:1px solid var(--border);
    padding:5px 4px;
    text-align:center;
    font-size:12px;
}
.items tfoot td{
    background:#fafafa;
    font-weight:600;
}

/* GST Breakup */
.gst-table{
    width:100%;
    margin-top:10px;
    border-collapse:collapse;
}
.gst-table th, .gst-table td{
    border:1px solid var(--border);
    padding:6px 4px;
    text-align:center;
    font-size:12px;
}
.gst-table th{
    background:var(--table);
    font-weight:600;
}

/* Amount Words */
.words{
    margin-top:12px;
    padding:10px;
    border-top:1px dashed var(--border);
    border-bottom:1px dashed var(--border);
    font-size:12px;
}

/* Declaration */
.declaration{
    margin-top:10px;
    text-align:center;
    font-size:11.5px;
    line-height:1.4;
}

/* Signature */
.sign{
    margin-top:12px;
    display:flex;
    justify-content:space-between;
    padding:10px;
    font-size:11.5px;
}

/* Print */
@media print{
    thead{ display:table-header-group; }
    tfoot{ display:table-footer-group; }
    tr{ page-break-inside:avoid; }
}
</style>
</head>

<body>

<!-- Header -->
<div class="header">
    <img src="/static/onlylogo.png" alt="Company Logo">
    <div class="header-title">TAX INVOICE</div>
</div>


<!-- Parties -->
<div class="section-title">Invoice Parties</div>
<table class="party-table">
<tr>
<td>
    <div class="party-title">Supplier</div>
    {{ invoice.supplier.name }}<br>
    {{ invoice.supplier.address | replace('\n', '<br>') | safe }}<br>
    Mob: {{ invoice.supplier.phone or '-' }}<br>
    GSTIN: {{ invoice.supplier.gstin }}<br>
    State Code: {{ invoice.distributor.state_code or '' }}<br>
    Email: {{ invoice.supplier.email or '-' }}
</td>

<td>
    <div class="party-title">Buyer (Bill To)</div>
    {{ invoice.distributor.name }}<br>
    {{ invoice.distributor.address | replace('\n', '<br>') | safe }}<br>
    GSTIN: {{ invoice.distributor.gstin or '-' }}<br>
    State: {{ invoice.distributor.state or '-' }} ({{ invoice.distributor.state_code or '-' }})<br>
</td>

<td>
    <div class="party-title">Ship To</div>
    {{ invoice.distributor.name }}<br>
    {{ invoice.distributor.address | replace('\n', '<br>') | safe }}<br>
    GSTIN: {{ invoice.distributor.gstin or '-' }}<br>
    State: {{ invoice.distributor.state or '-' }}
</td>
</tr>
</table>


<!-- Invoice Meta -->
<div class="section-title">Invoice Details</div>
<table class="meta-table">
<tr>
    <td class="meta-label">Invoice No:</td><td>{{ invoice.invoice_number }}</td>
    <td class="meta-label">Date:</td><td>{{ invoice.date }}</td>
</tr>
<tr>
    <td class="meta-label">Reverse Charge:</td><td>No</td>
    <td class="meta-label">Vehicle No:</td><td>-</td>
</tr>
<tr>
    <td class="meta-label">Transport:</td><td>-</td>
    <td class="meta-label">Mode/Terms:</td><td>-</td>
</tr>
</table>


<!-- Items -->
<div class="section-title">Items</div>

<table class="items">
<thead>
<tr>
    <th>SL</th>
    <th>Product</th>
    <th>HSN</th>
    <th>PCS</th>
    <th>CS</th>
    <th>Rate</th>
    <th>Disc%</th>
    <th>Taxable</th>
    <th>GST%</th>
    <th>Total</th>
</tr>
</thead>

<tbody>
{% for it in invoice.items %}
<tr>
    <td>{{ loop.index }}</td>
    <td>{{ it.description }}</td>
    <td>{{ it.hsn or '' }}</td>
    <td>{{ it.qty }}</td>
    <td>{{ it.cs or 0 }}</td>
    <td>{{ "%.2f"|format(it.rate) }}</td>
    <td>{{ it.disc_percent or 0 }}%</td>
    <td>{{ "%.2f"|format(it.taxable_value) }}</td>
    <td>{{ "%.2f"|format(it.gst_percent) }}</td>
    <td>{{ "%.2f"|format(it.gst_amount + it.taxable_value) }}</td>
</tr>
{% endfor %}
</tbody>

<tfoot>
<tr>
    <td colspan="3"><b>Total</b></td>
    <td><b>{{ invoice.total_pcs or '' }}</b></td>
    <td><b>{{ invoice.total_cs or '' }}</b></td>
    <td></td>
    <td></td>
    <td><b>{{ "%.2f"|format(invoice.totals.taxable_total) }}</b></td>
    <td></td>
    <td><b>{{ "%.2f"|format(invoice.totals.grand_total) }}</b></td>
</tr>
</tfoot>
</table>


<!-- GST BREAKUP -->
<div class="section-title">GST Breakup (HSN Summary)</div>

<table class="gst-table">
<thead>
<tr>
    <th>HSN Code</th>
    <th>Taxable Value</th>
    <th>CGST</th>
    <th>SGST</th>
    <th>Total GST</th>
    <th>GST%</th>
</tr>
</thead>

<tbody>
{% for rate, row in invoice.gst_summary.items() %}
<tr>
    <td>{{ rate }}</td>
    <td>{{ "%.2f"|format(row.taxable_value) }}</td>
    <td>{{ "%.2f"|format(row.cgst) }}</td>
    <td>{{ "%.2f"|format(row.sgst) }}</td>
    <td>{{ "%.2f"|format(row.gst_amount) }}</td>
    <td>{{ "%.2f"|format(row.gst_percent) }}%</td>
</tr>
{% endfor %}
</tbody>

<tfoot>
<tr>
    <td><b>Total</b></td>
    <td><b>{{ "%.2f"|format(invoice.totals.taxable_total) }}</b></td>
    <td><b>{{ "%.2f"|format(invoice.totals.total_cgst or 0) }}</b></td>
    <td><b>{{ "%.2f"|format(invoice.totals.total_sgst or 0) }}</b></td>
    <td><b>{{ "%.2f"|format(invoice.totals.gst_total) }}</b></td>
    <td></td>
</tr>
</tfoot>
</table>


<!-- AMOUNT IN WORDS -->
<div class="words">
<b>Amount in Words:</b><br>
{{ invoice.amount_in_words }}
</div>


<!-- DECLARATION -->
<div class="declaration">
We declare that this invoice shows the actual price of the goods described and that all particulars are true and correct.
</div>


<!-- SIGN -->
<div class="sign">
    <div><br>Customer Seal & Signature</div>
    <div>For <b>{{ invoice.supplier.name }}</b><br><br><br>Authorized Signatory</div>
</div>

<div style="text-align:center; margin-top:10px; font-size:11.5px; color:#525252;">
    <b>This is a Computer Generated Invoice.</b>
</div>

</body>
</html>
